let k8s = ./dhall-kubernetes/typesUnion.dhall

let simpleDeployment = ./simpleDeployment

let mkIstioService = ./mkIstioService

let ServiceSpec = { name : Text, port : Natural, tag : Text }

in    λ(spec : ServiceSpec)
    → [ k8s.Deployment
	( simpleDeployment
	  { name = spec.name, port = spec.port, tag = spec.tag }
	)
      , k8s.Service
	( mkIstioService
	  { name =
	      spec.name
	  , ports =
	      [ { targetPort = spec.port, port = spec.port, name = "http" } ]
	  }
	)
      ]
